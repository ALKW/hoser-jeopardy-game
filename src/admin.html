<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../styles/styles.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  </head>
  <body style="background: #fff;">
    <div class="admin-pannel">
      <div class="current-question">
        <p id="question"></p>
        <i id="answer"></i>
      <div>
      <div class="players">
      </div>
    </div>
    <script>
      var electron = require('electron');
      var ipcRenderer = electron.ipcRenderer;
      var value = 0;
      ipcRenderer.on('send-answer-to-admin-reply', function(event, data) {
        document.getElementById('question').innerHTML = data.question;
        document.getElementById('answer').innerHTML = data.answer;
        value = data.value;
      });
      
      ipcRenderer.on('launch-admin-pannel', function(event, data) {
        setupPlayers(data.players);
      });

      function setupPlayers(players) {
        var targetDiv = document.querySelector(".players");
        players.forEach(player => {
          var playerDiv = document.createElement("DIV");
          playerDiv.innerHTML = `
            <button data-player="${player}" class="correct-button"><i class="fa fa-check-circle fa-2x"></i></button>
            <span>${player}</span>
            <button data-player="${player}" class="incorrect-button"><i class="fa fa-times-circle fa-2x"></i></button>
          `;
          targetDiv.appendChild(playerDiv);
        });
        document.querySelectorAll(".correct-button").forEach(node => {
          node.addEventListener("click", function(event) {
            ipcRenderer.send("handle-answer", {
              player: this.dataset.player,
              value: value,
              type: 'CORRECT'
            });
          });
        });
        document.querySelectorAll(".incorrect-button").forEach(node => {
          node.addEventListener("click", function(event) {
            ipcRenderer.send("handle-answer", {
              player: this.dataset.player,
              value: value,
              type: 'INCORRECT'
            });
            this.parentNode.innerHTML = this.dataset.player;
          });
        });
      }
    </script>
  </body>
</html>
